import{d as P,c as w,o as m,a as n,m as y,n as A,t as M,p as Me,q as V,s as Re,v as Le,x as $e,r as R,y as q,b as Be,g as r,u as d,f as $,l as T,w as l,N as b,i as I,F as Ee,j as Ae,z as U,h as ze}from"./index-BH-S8nGy.js";import{_ as We}from"./xiaoyugan-Dwisk7G8.js";import{T as De,A as Y,H as Pe}from"./ThemeToggle-j2usGr5R.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as Oe,T as Ne,C as je,a as Q,E as He}from"./TrashBin-mriCgKnO.js";import{R as ee}from"./Refresh-Ddqf3QFR.js";const qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ve=n("path",{d:"M408 480H184a72 72 0 0 1-72-72V184a72 72 0 0 1 72-72h224a72 72 0 0 1 72 72v224a72 72 0 0 1-72 72z",fill:"currentColor"},null,-1),Ge=n("path",{d:"M160 80h235.88A72.12 72.12 0 0 0 328 32H104a72 72 0 0 0-72 72v224a72.12 72.12 0 0 0 48 67.88V160a80 80 0 0 1 80-80z",fill:"currentColor"},null,-1),Je=[Ve,Ge],Ke=P({name:"Copy",render:function(a,o){return m(),w("svg",qe,Je)}}),Ze={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Xe=n("path",{d:"M218.1 167.17c0 13 0 25.6 4.1 37.4c-43.1 50.6-156.9 184.3-167.5 194.5a20.17 20.17 0 0 0-6.7 15c0 8.5 5.2 16.7 9.6 21.3c6.6 6.9 34.8 33 40 28c15.4-15 18.5-19 24.8-25.2c9.5-9.3-1-28.3 2.3-36s6.8-9.2 12.5-10.4s15.8 2.9 23.7 3c8.3.1 12.8-3.4 19-9.2c5-4.6 8.6-8.9 8.7-15.6c.2-9-12.8-20.9-3.1-30.4s23.7 6.2 34 5s22.8-15.5 24.1-21.6s-11.7-21.8-9.7-30.7c.7-3 6.8-10 11.4-11s25 6.9 29.6 5.9c5.6-1.2 12.1-7.1 17.4-10.4c15.5 6.7 29.6 9.4 47.7 9.4c68.5 0 124-53.4 124-119.2S408.5 48 340 48s-121.9 53.37-121.9 119.17zM400 144a32 32 0 1 1-32-32a32 32 0 0 1 32 32z",fill:"currentColor"},null,-1),Ye=[Xe],Qe=P({name:"Key",render:function(a,o){return m(),w("svg",Ze,Ye)}}),es={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ss=n("path",{d:"M200.66 352H144a96 96 0 0 1 0-192h55.41",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48"},null,-1),ts=n("path",{d:"M312.59 160H368a96 96 0 0 1 0 192h-56.66",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48"},null,-1),os=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M169.07 256h175.86"},null,-1),rs=[ss,ts,os],ns=P({name:"Link",render:function(a,o){return m(),w("svg",es,rs)}}),ls={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},as=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"48",d:"M88 152h336"},null,-1),is=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"48",d:"M88 256h336"},null,-1),cs=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"48",d:"M88 360h336"},null,-1),us=[as,is,cs],ds=P({name:"Menu",render:function(a,o){return m(),w("svg",ls,us)}}),ps={name:"ImportToken",data(){return{selectedFile:null,progressPercent:0,showProgress:!1,statusMessage:"",statusType:"",showStatusMessage:!1,extractedToken:"",showResult:!1,responseDetails:"",showResponseInfo:!1,debugDetails:"",showDebugInfo:!1,wssLink:"",isUploading:!1}},computed:{fileInfoText(){return this.selectedFile?`Â∑≤ÈÄâÊã©: ${this.selectedFile.name} (${this.formatFileSize(this.selectedFile.size)})`:""}},methods:{handleUploadAreaClick(u){u.target!==this.$refs.fileInput&&this.$refs.fileInput.click()},highlight(){document.getElementById("uploadArea").classList.add("dragover")},unhighlight(){document.getElementById("uploadArea").classList.remove("dragover")},handleDrop(u){this.unhighlight();const o=u.dataTransfer.files;o.length&&this.handleFiles(o)},handleFileChange(){this.$refs.fileInput.files.length&&this.handleFiles(this.$refs.fileInput.files)},handleFiles(u){const a=u[0];if(!a.name.toLowerCase().endsWith(".bin")){this.showStatus("ËØ∑ÈÄâÊã©.binÊ†ºÂºèÁöÑÊñá‰ª∂","error");return}this.selectedFile=a},formatFileSize(u){if(u===0)return"0 Bytes";const a=1024,o=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(u)/Math.log(a));return parseFloat((u/Math.pow(a,f)).toFixed(2))+" "+o[f]},async uploadFile(){var u;if(!this.selectedFile){this.showStatus("ËØ∑ÂÖàÈÄâÊã©Êñá‰ª∂","error");return}this.isUploading=!0,this.showProgress=!0,this.progressPercent=0,this.showStatus("Ê≠£Âú®‰∏ä‰º†Êñá‰ª∂...","");try{const a=await this.readFileAsArrayBuffer(this.selectedFile),o=new XMLHttpRequest;o.open("POST","https://xxz-xyzw.hortorgames.com/login/authuser?_seq=1",!0),o.responseType="arraybuffer",o.upload.addEventListener("progress",f=>{if(f.lengthComputable){const t=f.loaded/f.total*100;this.progressPercent=Math.round(t)}}),await new Promise((f,t)=>{o.addEventListener("load",()=>{if(o.status>=200&&o.status<300)try{const c=o.response;c?(this.extractRoleToken(c),this.showStatus("TokenÊèêÂèñÊàêÂäüÔºÅ","success"),f()):(this.showStatus("‰∏ä‰º†ÊàêÂäüÔºå‰ΩÜÂìçÂ∫î‰∏∫Á©∫","error"),t(new Error("Empty response")))}catch(c){this.showStatus("Â§ÑÁêÜÂìçÂ∫îÊó∂Âá∫Èîô: "+c.message,"error"),t(c)}else this.showStatus("‰∏ä‰º†Â§±Ë¥•: "+o.statusText,"error"),t(new Error(`HTTP error: ${o.status}`))}),o.addEventListener("error",()=>{this.showStatus("‰∏ä‰º†ËøáÁ®ã‰∏≠ÂèëÁîüÈîôËØØ","error"),t(new Error("Network error"))}),o.setRequestHeader("Content-Type","application/octet-stream"),o.send(a)}),this.$emit("sucessData",this.wssLink,(u=this.selectedFile.name)==null?void 0:u.split(".")[0])}catch(a){console.error("Upload error:",a)}finally{this.isUploading=!1}},readFileAsArrayBuffer(u){return new Promise((a,o)=>{const f=new FileReader;f.onload=t=>a(t.target.result),f.onerror=()=>o(f.error),f.readAsArrayBuffer(u)})},extractRoleToken(u){try{const a=new Uint8Array(u);let o="";for(let t=0;t<a.length;t++)a[t]>=32&&a[t]<=126?o+=String.fromCharCode(a[t]):o+=".";this.debugDetails=`ASCIIÈ¢ÑËßà:
`+o,this.showDebugInfo=!0;const f=o.indexOf("Token");if(f!==-1){let t=f+5;for(;t<o.length;){const S=o[t];if(this.isBase64Char(S))break;t++}let c=t;for(;c<o.length&&this.isBase64Char(o[c]);)c++;const p=o.substring(t,c);if(p.length>0){this.extractedToken=p,this.showResult=!0,this.generateAndDisplayWssLink(p);let S="";for(let L=0;L<a.length;L++)(L+1)%16===0&&(S+=`
`),S+=a[L].toString(16).padStart(2,"0")+" ";this.responseDetails=S,this.showResponseInfo=!0,this.$nextTick(()=>{document.querySelector(".result-container").scrollIntoView({behavior:"smooth"})})}else this.showStatus("ÊâæÂà∞TokenÊ†áËÆ∞‰ΩÜÊú™ÊâæÂà∞TokenÂÄº","error")}else this.showStatus("Âú®ÂìçÂ∫î‰∏≠Êú™ÊâæÂà∞TokenÊ†áËÆ∞","error")}catch(a){this.showStatus("ÊèêÂèñTokenÊó∂ÂèëÁîüÈîôËØØ: "+a.message,"error")}},isBase64Char(u){return/[A-Za-z0-9+/=]/.test(u)},showStatus(u,a){this.statusMessage=u,this.statusType=a||"",this.showStatusMessage=!0},copyToken(){this.extractedToken&&navigator.clipboard.writeText(this.extractedToken).then(()=>this.showStatus("TokenÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø","success")).catch(()=>this.showStatus("Â§çÂà∂Â§±Ë¥•","error"))},copyWssLink(){this.wssLink&&navigator.clipboard.writeText(this.wssLink).then(()=>this.showStatus("WSSÈìæÊé•Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø","success")).catch(()=>this.showStatus("Â§çÂà∂Â§±Ë¥•","error"))},generateAndDisplayWssLink(u){const a=Date.now(),o=a*100+Math.floor(Math.random()*100),f=a+Math.floor(Math.random()*10);this.wssLink=`{"roleToken":"${u}","sessId":${o},"connId":${f},"isRestore":0}`}}},hs={class:"container"},ms={key:0,class:"file-info"},fs={key:1,class:"progress-container"},ks={class:"progress-bar"},gs={class:"progress-text"},vs=["disabled"];function _s(u,a,o,f,t,c){return m(),w("div",hs,[n("div",{class:"upload-area",id:"uploadArea",onClick:a[1]||(a[1]=(...p)=>c.handleUploadAreaClick&&c.handleUploadAreaClick(...p)),onDragenter:a[2]||(a[2]=A((...p)=>c.highlight&&c.highlight(...p),["prevent"])),onDragover:a[3]||(a[3]=A((...p)=>c.highlight&&c.highlight(...p),["prevent"])),onDragleave:a[4]||(a[4]=A((...p)=>c.unhighlight&&c.unhighlight(...p),["prevent"])),onDrop:a[5]||(a[5]=A((...p)=>c.handleDrop&&c.handleDrop(...p),["prevent"]))},[a[7]||(a[7]=n("div",{class:"upload-icon"},"üìÇ",-1)),a[8]||(a[8]=n("p",{class:"upload-text"},"ÁÇπÂáªÊàñÊãñÊîæBINÊñá‰ª∂Âà∞Ê≠§Â§Ñ",-1)),a[9]||(a[9]=n("p",{class:"upload-subtext"},"‰ªÖÊîØÊåÅ .bin Ê†ºÂºèÊñá‰ª∂",-1)),n("input",{type:"file",ref:"fileInput",class:"file-input",accept:".bin",onChange:a[0]||(a[0]=(...p)=>c.handleFileChange&&c.handleFileChange(...p))},null,544)],32),t.selectedFile?(m(),w("div",ms,M(c.fileInfoText),1)):y("",!0),t.showProgress?(m(),w("div",fs,[n("div",ks,[n("div",{class:"progress",style:Me({width:t.progressPercent+"%"})},null,4)]),n("div",gs,M(t.progressPercent)+"%",1)])):y("",!0),t.showStatusMessage?(m(),w("div",{key:2,class:V(["status-message",t.statusType])},M(t.statusMessage),3)):y("",!0),n("button",{class:"btn",onClick:a[6]||(a[6]=(...p)=>c.uploadFile&&c.uploadFile(...p)),disabled:!t.selectedFile||t.isUploading},"‰∏ä‰º†BINÊñá‰ª∂ÊèêÂèñToken",8,vs)])}const ws=se(ps,[["render",_s],["__scopeId","data-v-742201f0"]]),Ts={class:"token-import-page"},bs={class:"container"},ys={class:"page-header"},xs={class:"header-content"},Us={class:"header-top"},Ss={key:0,class:"import-section"},Cs={class:"import-card"},Fs={class:"card-header"},Is={class:"optional-fields"},Ms={class:"form-actions"},Rs={class:"optional-fields"},Ls={class:"form-actions"},$s={key:1,class:"tokens-section"},Bs={class:"section-header"},Es={class:"header-actions"},As={class:"tokens-grid"},zs=["onClick"],Ws={class:"card-header"},Ds={class:"token-info"},Ps={class:"token-name"},Os={class:"token-meta"},Ns={key:0,class:"meta-item"},js={class:"card-actions"},Hs={class:"card-body"},qs={class:"token-display"},Vs={class:"token-value"},Gs={class:"connection-status"},Js={class:"status-indicator"},Ks={class:"status-text"},Zs={class:"connection-actions"},Xs={class:"token-timestamps"},Ys={class:"timestamp-item"},Qs={class:"timestamp-value"},et={class:"timestamp-item"},st={class:"timestamp-value"},tt={key:0,class:"card-footer"},ot={key:2,class:"empty-state"},rt={class:"modal-actions"},nt={__name:"TokenImport",setup(u){const a=ze(),o=Re(),f=Le(),t=$e(),c=R(!1),p=R(!1),S=R(!1),L=R(null),O=R(null),N=R(null),z=R(null),W=R("manual"),j=R(new Set),v=q({name:"",base64Token:"",server:"",wsUrl:""}),k=q({name:"",url:"",server:"",wsUrl:""}),C=q({name:"",server:"",wsUrl:""}),te={name:[{required:!0,message:"ËØ∑ËæìÂÖ•TokenÂêçÁß∞",trigger:"blur"}],base64Token:[{required:!0,message:"ËØ∑ËæìÂÖ•Base64 Token",trigger:"blur"}]},oe={name:[{required:!0,message:"ËØ∑ËæìÂÖ•TokenÂêçÁß∞",trigger:"blur"}],url:[{required:!0,message:"ËØ∑ËæìÂÖ•TokenËé∑ÂèñÂú∞ÂùÄ",trigger:"blur"},{type:"url",message:"ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑURLÂú∞ÂùÄ",trigger:"blur"}]},re={name:[{required:!0,message:"ËØ∑ËæìÂÖ•TokenÂêçÁß∞",trigger:"blur"}]},ne=[{label:"ÂØºÂá∫ÊâÄÊúâToken",key:"export"},{label:"ÂØºÂÖ•TokenÊñá‰ª∂",key:"import"},{label:"Ê∏ÖÁêÜËøáÊúüToken",key:"clean"},{label:"Êñ≠ÂºÄÊâÄÊúâËøûÊé•",key:"disconnect"},{label:"Ê∏ÖÈô§ÊâÄÊúâToken",key:"clear"}],le=async()=>{var s;if(L.value)try{await L.value.validate(),p.value=!0;const e=t.importBase64Token(v.name,v.base64Token,{server:v.server,wsUrl:v.wsUrl,importMethod:"manual"});if(e.success)o.success(e.message),e.details&&console.log("TokenÂØºÂÖ•ËØ¶ÊÉÖ:",e.details),ie(),c.value=!1;else{const F=e.error||e.message||"TokenÂØºÂÖ•Â§±Ë¥•";o.error(F),console.error("TokenÂØºÂÖ•ÈîôËØØËØ¶ÊÉÖ:",{error:e.error,message:e.message,originalToken:((s=v.base64Token)==null?void 0:s.substring(0,50))+"..."})}}catch{}finally{p.value=!1}},ae=async()=>{var s;if(O.value)try{await O.value.validate(),p.value=!0;let e;if(k.url.startsWith(window.location.origin)||k.url.startsWith("/")||k.url.startsWith("http://localhost")||k.url.startsWith("http://127.0.0.1"))e=await fetch(k.url);else try{e=await fetch(k.url,{method:"GET",headers:{Accept:"application/json"},mode:"cors"})}catch(_){throw new Error(`Ë∑®ÂüüËØ∑Ê±ÇË¢´ÈòªÊ≠¢„ÄÇËØ∑Á°Æ‰øùÁõÆÊ†áÊúçÂä°Âô®ÊîØÊåÅCORSÔºåÊàñ‰ΩøÁî®ÊµèËßàÂô®Êâ©Â±ï/‰ª£ÁêÜÊúçÂä°Âô®„ÄÇÈîôËØØËØ¶ÊÉÖ: ${_.message}`)}if(!e.ok)throw new Error(`ËØ∑Ê±ÇÂ§±Ë¥•: ${e.status} ${e.statusText}`);const g=await e.json();if(!g.token)throw new Error("ËøîÂõûÊï∞ÊçÆ‰∏≠Êú™ÊâæÂà∞tokenÂ≠óÊÆµ");const h=t.importBase64Token(k.name,g.token,{server:k.server||g.server,wsUrl:k.wsUrl,sourceUrl:k.url,importMethod:"url"});if(h.success)o.success(h.message),h.details&&console.log("URL TokenÂØºÂÖ•ËØ¶ÊÉÖ:",h.details),ce(),c.value=!1;else{const _=h.error||h.message||"URL TokenÂØºÂÖ•Â§±Ë¥•";o.error(_),console.error("URL TokenÂØºÂÖ•ÈîôËØØËØ¶ÊÉÖ:",{error:h.error,message:h.message,sourceUrl:k.url,receivedToken:((s=g==null?void 0:g.token)==null?void 0:s.substring(0,50))+"..."})}}catch(e){console.error("URLËé∑ÂèñTokenÂ§±Ë¥•:",e),o.error(e.message||"URLËé∑ÂèñTokenÂ§±Ë¥•")}finally{p.value=!1}},G=async s=>{if(!s.sourceUrl){o.warning("ËØ•TokenÊú™ÈÖçÁΩÆÂà∑Êñ∞Âú∞ÂùÄ");return}j.value.add(s.id);try{let e;if(s.sourceUrl.startsWith(window.location.origin)||s.sourceUrl.startsWith("/")||s.sourceUrl.startsWith("http://localhost")||s.sourceUrl.startsWith("http://127.0.0.1"))e=await fetch(s.sourceUrl);else try{e=await fetch(s.sourceUrl,{method:"GET",headers:{Accept:"application/json"},mode:"cors"})}catch(h){throw new Error(`Ë∑®ÂüüËØ∑Ê±ÇË¢´ÈòªÊ≠¢„ÄÇËØ∑Á°Æ‰øùÁõÆÊ†áÊúçÂä°Âô®ÊîØÊåÅCORS„ÄÇÈîôËØØËØ¶ÊÉÖ: ${h.message}`)}if(!e.ok)throw new Error(`ËØ∑Ê±ÇÂ§±Ë¥•: ${e.status} ${e.statusText}`);const g=await e.json();if(!g.token)throw new Error("ËøîÂõûÊï∞ÊçÆ‰∏≠Êú™ÊâæÂà∞tokenÂ≠óÊÆµ");t.updateToken(s.id,{token:g.token,server:g.server||s.server,lastRefreshed:Date.now()}),t.getWebSocketStatus(s.id)==="connected"&&(t.closeWebSocketConnection(s.id),setTimeout(()=>{t.createWebSocketConnection(s.id,g.token,s.wsUrl)},500)),o.success("TokenÂà∑Êñ∞ÊàêÂäü")}catch(e){console.error("Âà∑Êñ∞TokenÂ§±Ë¥•:",e),o.error(e.message||"TokenÂà∑Êñ∞Â§±Ë¥•")}finally{j.value.delete(s.id)}},ie=()=>{Object.keys(v).forEach(s=>{v[s]=""})},ce=()=>{Object.keys(k).forEach(s=>{k[s]=""})},ue=s=>{t.selectToken(s.id),o.success(`Â∑≤ÈÄâÊã©Ôºö${s.name}`)},B=s=>t.getWebSocketStatus(s),de=s=>{switch(B(s)){case"connected":return"Â∑≤ËøûÊé•";case"connecting":return"ËøûÊé•‰∏≠";case"error":return"ËøûÊé•ÈîôËØØ";default:return"Êú™ËøûÊé•"}},pe=s=>{B(s.id)==="connected"?(t.closeWebSocketConnection(s.id),o.info("WebSocketËøûÊé•Â∑≤Êñ≠ÂºÄ")):(t.createWebSocketConnection(s.id,s.token,s.wsUrl),o.success("Ê≠£Âú®Âª∫Á´ãWebSocketËøûÊé•..."))},he=s=>{const e=[{label:"ÁºñËæë",key:"edit",icon:()=>U(b,null,{default:()=>U(je)})},{label:"Â§çÂà∂Token",key:"copy",icon:()=>U(b,null,{default:()=>U(Ke)})}];return s.importMethod==="url"&&s.sourceUrl?e.push({label:"‰ªéURLÂà∑Êñ∞",key:"refresh-url",icon:()=>U(b,null,{default:()=>U(Oe)})}):e.push({label:"Âà∑Êñ∞Token",key:"refresh",icon:()=>U(b,null,{default:()=>U(ee)})}),e.push({label:"ÈáçÊñ∞ËøûÊé•",key:"reconnect",icon:()=>U(b,null,{default:()=>U(ns)})},{type:"divider"},{label:"Âà†Èô§",key:"delete",icon:()=>U(b,null,{default:()=>U(Ne)}),props:{style:{color:"#e74c3c"}}}),e},me=async(s,e)=>{switch(s){case"edit":fe(e);break;case"copy":ge(e);break;case"refresh":o.info("ÊâãÂä®Ê∑ªÂä†ÁöÑTokenÊöÇ‰∏çÊîØÊåÅÂà∑Êñ∞ÔºåËØ∑ÈáçÊñ∞ÂØºÂÖ•");break;case"refresh-url":G(e);break;case"reconnect":ve(e);break;case"delete":_e(e);break}},fe=s=>{z.value=s,Object.assign(C,{name:s.name,server:s.server||"",wsUrl:s.wsUrl||""}),S.value=!0},ke=async()=>{if(!(!N.value||!z.value))try{await N.value.validate(),t.updateToken(z.value.id,{name:C.name,server:C.server,wsUrl:C.wsUrl}),o.success("Token‰ø°ÊÅØÂ∑≤Êõ¥Êñ∞"),S.value=!1,z.value=null}catch{}},ge=async s=>{try{await navigator.clipboard.writeText(s.token),o.success("TokenÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø")}catch{o.error("Â§çÂà∂Â§±Ë¥•")}},ve=s=>{t.closeWebSocketConnection(s.id),setTimeout(()=>{t.createWebSocketConnection(s.id,s.token,s.wsUrl),o.success("Ê≠£Âú®ÈáçÊñ∞ËøûÊé•...")},500)},_e=s=>{f.warning({title:"Âà†Èô§Token",content:`Á°ÆÂÆöË¶ÅÂà†Èô§Token "${s.name}" ÂêóÔºüÊ≠§Êìç‰ΩúÊó†Ê≥ïÊÅ¢Â§ç„ÄÇ`,positiveText:"Á°ÆÂÆöÂà†Èô§",negativeText:"ÂèñÊ∂à",onPositiveClick:()=>{t.removeToken(s.id),o.success("TokenÂ∑≤Âà†Èô§")}})},we=s=>{switch(s){case"export":Te();break;case"import":be();break;case"clean":ye();break;case"disconnect":xe();break;case"clear":Ue();break}},Te=()=>{try{const s=t.exportTokens(),e=JSON.stringify(s,null,2),F=new Blob([e],{type:"application/json"}),g=document.createElement("a");g.href=URL.createObjectURL(F),g.download=`tokens_backup_${new Date().toISOString().split("T")[0]}.json`,g.click(),o.success("TokenÊï∞ÊçÆÂ∑≤ÂØºÂá∫")}catch{o.error("ÂØºÂá∫Â§±Ë¥•")}},be=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=e=>{const F=e.target.files[0];if(F){const g=new FileReader;g.onload=h=>{try{const _=JSON.parse(h.target.result),E=t.importTokens(_);E.success?o.success(E.message):o.error(E.message)}catch{o.error("Êñá‰ª∂Ê†ºÂºèÈîôËØØ")}},g.readAsText(F)}},s.click()},ye=()=>{const s=t.cleanExpiredTokens();o.success(`Â∑≤Ê∏ÖÁêÜ ${s} ‰∏™ËøáÊúüToken`)},xe=()=>{t.gameTokens.forEach(s=>{t.closeWebSocketConnection(s.id)}),o.success("ÊâÄÊúâËøûÊé•Â∑≤Êñ≠ÂºÄ")},Ue=()=>{f.error({title:"Ê∏ÖÈô§ÊâÄÊúâToken",content:"Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâTokenÂêóÔºüÊ≠§Êìç‰ΩúÊó†Ê≥ïÊÅ¢Â§çÔºÅ",positiveText:"Á°ÆÂÆöÊ∏ÖÈô§",negativeText:"ÂèñÊ∂à",onPositiveClick:()=>{t.clearAllTokens(),o.success("ÊâÄÊúâTokenÂ∑≤Ê∏ÖÈô§")}})},Se=s=>{if(!s)return"";const e=s.length;return e<=8?s:s.substring(0,4)+"***"+s.substring(e-4)},J=s=>new Date(s).toLocaleString("zh-CN"),K=()=>{a.push("/dashboard")};Be(()=>{t.initTokenStore(),t.hasTokens||(c.value=!0)});const Ce=(s,e)=>{v.base64Token=s,v.name=e};return(s,e)=>{const F=I("n-radio-button"),g=I("n-radio-group"),h=I("n-input"),_=I("n-form-item"),E=I("n-collapse-item"),Z=I("n-collapse"),x=I("n-button"),H=I("n-form"),X=I("n-dropdown"),Fe=I("n-empty"),Ie=I("n-modal");return m(),w("div",Ts,[n("div",bs,[n("div",ys,[n("div",xs,[n("div",Us,[e[17]||(e[17]=n("img",{src:We,alt:"XYZW",class:"brand-logo"},null,-1)),r(De)]),e[18]||(e[18]=n("h1",null,"Ê∏∏ÊàèTokenÁÆ°ÁêÜ",-1))])]),!d(t).hasTokens||c.value?(m(),w("div",Ss,[r(ws,{onSucessData:Ce,style:{"margin-bottom":"20px"}}),n("div",Cs,[n("div",Fs,[n("h2",null,[r(d(b),null,{default:l(()=>[r(d(Y))]),_:1}),e[19]||(e[19]=T(" Ê∑ªÂä†Ê∏∏ÊàèToken ",-1))]),r(g,{value:W.value,"onUpdate:value":e[0]||(e[0]=i=>W.value=i),class:"import-method-tabs",size:"small"},{default:l(()=>[r(F,{value:"manual"},{default:l(()=>e[20]||(e[20]=[T(" ÊâãÂä®ËæìÂÖ• ",-1)])),_:1,__:[20]}),r(F,{value:"url"},{default:l(()=>e[21]||(e[21]=[T(" URLËé∑Âèñ ",-1)])),_:1,__:[21]})]),_:1},8,["value"])]),W.value==="manual"?(m(),$(H,{key:0,ref_key:"importFormRef",ref:L,model:v,rules:te,"label-placement":"top",size:"large","show-label":!0},{default:l(()=>[r(_,{label:"Ê∏∏ÊàèËßíËâ≤ÂêçÁß∞",path:"name","show-label":!0},{default:l(()=>[r(h,{value:v.name,"onUpdate:value":e[1]||(e[1]=i=>v.name=i),placeholder:"‰æãÂ¶ÇÔºö‰∏ªÂè∑ÊàòÂ£´",clearable:""},null,8,["value"])]),_:1}),r(_,{label:"TokenÂ≠óÁ¨¶‰∏≤",path:"base64Token","show-label":!0},{default:l(()=>[r(h,{value:v.base64Token,"onUpdate:value":e[2]||(e[2]=i=>v.base64Token=i),type:"textarea",rows:3,placeholder:"Á≤òË¥¥TokenÂ≠óÁ¨¶‰∏≤...",clearable:""},null,8,["value"])]),_:1}),r(Z,null,{default:l(()=>[r(E,{title:"ËßíËâ≤ËØ¶ÊÉÖ (ÂèØÈÄâ)",name:"optional"},{default:l(()=>[n("div",Is,[r(_,{label:"ÊúçÂä°Âô®"},{default:l(()=>[r(h,{value:v.server,"onUpdate:value":e[3]||(e[3]=i=>v.server=i),placeholder:"ÊúçÂä°Âô®ÂêçÁß∞"},null,8,["value"])]),_:1}),r(_,{label:"Ëá™ÂÆö‰πâËøûÊé•Âú∞ÂùÄ"},{default:l(()=>[r(h,{value:v.wsUrl,"onUpdate:value":e[4]||(e[4]=i=>v.wsUrl=i),placeholder:"ÁïôÁ©∫‰ΩøÁî®ÈªòËÆ§ËøûÊé•"},null,8,["value"])]),_:1})])]),_:1})]),_:1}),n("div",Ms,[r(x,{type:"primary",size:"large",block:"",loading:p.value,onClick:le},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Q))]),_:1})]),default:l(()=>[e[22]||(e[22]=T(" Ê∑ªÂä†Token ",-1))]),_:1,__:[22]},8,["loading"]),d(t).hasTokens?(m(),$(x,{key:0,size:"large",block:"",onClick:e[5]||(e[5]=i=>c.value=!1)},{default:l(()=>e[23]||(e[23]=[T(" ÂèñÊ∂à ",-1)])),_:1,__:[23]})):y("",!0)])]),_:1},8,["model"])):y("",!0),W.value==="url"?(m(),$(H,{key:1,ref_key:"urlFormRef",ref:O,model:k,rules:oe,"label-placement":"top",size:"large"},{default:l(()=>[r(_,{label:"Ê∏∏ÊàèËßíËâ≤ÂêçÁß∞",path:"name"},{default:l(()=>[r(h,{value:k.name,"onUpdate:value":e[6]||(e[6]=i=>k.name=i),placeholder:"‰æãÂ¶ÇÔºö‰∏ªÂè∑ÊàòÂ£´",clearable:""},null,8,["value"])]),_:1}),r(_,{label:"TokenËé∑ÂèñÂú∞ÂùÄ",path:"url"},{feedback:l(()=>e[24]||(e[24]=[n("div",{class:"form-tips"},[n("span",{class:"form-tip"}," Êé•Âè£Â∫îËøîÂõûÂåÖÂê´tokenÂ≠óÊÆµÁöÑJSONÊï∞ÊçÆ "),n("span",{class:"form-tip cors-tip"}," Ê≥®ÊÑèÔºöÂ¶ÇÊûúÊòØË∑®ÂüüURLÔºåÊúçÂä°Âô®ÈúÄË¶ÅÊîØÊåÅCORSÔºåÂê¶Âàô‰ºöË¢´ÊµèËßàÂô®ÈòªÊ≠¢ ")],-1)])),default:l(()=>[r(h,{value:k.url,"onUpdate:value":e[7]||(e[7]=i=>k.url=i),placeholder:"ËæìÂÖ•APIÊé•Âè£Âú∞ÂùÄ...",clearable:""},null,8,["value"])]),_:1}),r(Z,null,{default:l(()=>[r(E,{title:"ËßíËâ≤ËØ¶ÊÉÖ (ÂèØÈÄâ)",name:"optional"},{default:l(()=>[n("div",Rs,[r(_,{label:"ÊúçÂä°Âô®"},{default:l(()=>[r(h,{value:k.server,"onUpdate:value":e[8]||(e[8]=i=>k.server=i),placeholder:"ÊúçÂä°Âô®ÂêçÁß∞"},null,8,["value"])]),_:1}),r(_,{label:"Ëá™ÂÆö‰πâËøûÊé•Âú∞ÂùÄ"},{default:l(()=>[r(h,{value:k.wsUrl,"onUpdate:value":e[9]||(e[9]=i=>k.wsUrl=i),placeholder:"ÁïôÁ©∫‰ΩøÁî®ÈªòËÆ§ËøûÊé•"},null,8,["value"])]),_:1})])]),_:1})]),_:1}),n("div",Ls,[r(x,{type:"primary",size:"large",block:"",loading:p.value,onClick:ae},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Q))]),_:1})]),default:l(()=>[e[25]||(e[25]=T(" Ëé∑ÂèñÂπ∂Ê∑ªÂä†Token ",-1))]),_:1,__:[25]},8,["loading"]),d(t).hasTokens?(m(),$(x,{key:0,size:"large",block:"",onClick:e[10]||(e[10]=i=>c.value=!1)},{default:l(()=>e[26]||(e[26]=[T(" ÂèñÊ∂à ",-1)])),_:1,__:[26]})):y("",!0)])]),_:1},8,["model"])):y("",!0)])])):y("",!0),d(t).hasTokens?(m(),w("div",$s,[n("div",Bs,[n("h2",null,"ÊàëÁöÑTokenÂàóË°® ("+M(d(t).gameTokens.length)+"‰∏™)",1),n("div",Es,[d(t).selectedToken?(m(),$(x,{key:0,type:"success",onClick:K},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Pe))]),_:1})]),default:l(()=>[e[27]||(e[27]=T(" ËøîÂõûÊéßÂà∂Âè∞ ",-1))]),_:1,__:[27]})):y("",!0),c.value?y("",!0):(m(),$(x,{key:1,type:"primary",onClick:e[11]||(e[11]=i=>c.value=!0)},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Y))]),_:1})]),default:l(()=>[e[28]||(e[28]=T(" Ê∑ªÂä†Token ",-1))]),_:1,__:[28]})),r(X,{options:ne,onSelect:we},{default:l(()=>[r(x,null,{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(ds))]),_:1})]),default:l(()=>[e[29]||(e[29]=T(" ÊâπÈáèÊìç‰Ωú ",-1))]),_:1,__:[29]})]),_:1})])]),n("div",As,[(m(!0),w(Ee,null,Ae(d(t).gameTokens,i=>(m(),w("div",{key:i.id,class:V(["token-card",{active:i.id===d(t).selectedTokenId,connected:B(i.id)==="connected"}]),onClick:D=>ue(i)},[n("div",Ws,[n("div",Ds,[n("h3",Ps,M(i.name),1),n("div",Os,[i.server?(m(),w("span",Ns,M(i.server),1)):y("",!0)])]),n("div",js,[r(X,{options:he(i),onSelect:D=>me(D,i)},{default:l(()=>[r(x,{text:""},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(He))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])])]),n("div",Hs,[n("div",qs,[e[30]||(e[30]=n("span",{class:"token-label"},"Token:",-1)),n("code",Vs,M(Se(i.token)),1)]),n("div",Gs,[n("div",Js,[n("span",{class:V(["status-dot",B(i.id)])},null,2),n("span",Ks,M(de(i.id)),1)]),n("div",Zs,[i.sourceUrl?(m(),$(x,{key:0,size:"small",type:"default",loading:j.value.has(i.id),onClick:A(D=>G(i),["stop"])},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(ee))]),_:1})]),default:l(()=>[e[31]||(e[31]=T(" Âà∑Êñ∞ ",-1))]),_:2,__:[31]},1032,["loading","onClick"])):y("",!0),r(x,{size:"small",type:B(i.id)==="connected"?"warning":"primary",onClick:A(D=>pe(i),["stop"])},{default:l(()=>[T(M(B(i.id)==="connected"?"Êñ≠ÂºÄ":"ËøûÊé•"),1)]),_:2},1032,["type","onClick"])])]),n("div",Xs,[n("div",Ys,[e[32]||(e[32]=n("span",{class:"timestamp-label"},"ÂàõÂª∫Ôºö",-1)),n("span",Qs,M(J(i.createdAt)),1)]),n("div",et,[e[33]||(e[33]=n("span",{class:"timestamp-label"},"‰ΩøÁî®Ôºö",-1)),n("span",st,M(J(i.lastUsed)),1)])])]),i.id===d(t).selectedTokenId?(m(),w("div",tt,[r(x,{type:"primary",block:"",onClick:K},{default:l(()=>e[34]||(e[34]=[T(" ÂºÄÂßã‰ªªÂä°ÁÆ°ÁêÜ ",-1)])),_:1,__:[34]})])):y("",!0)],10,zs))),128))])])):y("",!0),!d(t).hasTokens&&!c.value?(m(),w("div",ot,[r(Fe,{size:"large",description:"ËøòÊ≤°ÊúâÂØºÂÖ•‰ªª‰ΩïToken"},{icon:l(()=>[r(d(b),{size:"64"},{default:l(()=>[r(d(Qe))]),_:1})]),_:1})])):y("",!0)]),r(Ie,{show:S.value,"onUpdate:show":e[16]||(e[16]=i=>S.value=i),preset:"card",title:"ÁºñËæëToken",style:{width:"500px"}},{footer:l(()=>[n("div",rt,[r(x,{onClick:e[15]||(e[15]=i=>S.value=!1)},{default:l(()=>e[35]||(e[35]=[T(" ÂèñÊ∂à ",-1)])),_:1,__:[35]}),r(x,{type:"primary",onClick:ke},{default:l(()=>e[36]||(e[36]=[T(" ‰øùÂ≠ò ",-1)])),_:1,__:[36]})])]),default:l(()=>[r(H,{ref_key:"editFormRef",ref:N,model:C,rules:re,"label-placement":"left","label-width":"80px"},{default:l(()=>[r(_,{label:"ÂêçÁß∞",path:"name"},{default:l(()=>[r(h,{value:C.name,"onUpdate:value":e[12]||(e[12]=i=>C.name=i)},null,8,["value"])]),_:1}),r(_,{label:"ÊúçÂä°Âô®"},{default:l(()=>[r(h,{value:C.server,"onUpdate:value":e[13]||(e[13]=i=>C.server=i)},null,8,["value"])]),_:1}),r(_,{label:"WebSocketÂú∞ÂùÄ"},{default:l(()=>[r(h,{value:C.wsUrl,"onUpdate:value":e[14]||(e[14]=i=>C.wsUrl=i)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])])}}},pt=se(nt,[["__scopeId","data-v-d340f9a8"]]);export{pt as default};
