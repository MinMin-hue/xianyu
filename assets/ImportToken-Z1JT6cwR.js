import{c as l,e as c,a as n,m as u,n as g,t as d,p as k,q as w,o as h}from"./index-DhCM_Bam.js";import{_ as v}from"./_plugin-vue_export-helper-DlAUqK2U.js";const m={name:"ImportToken",data(){return{selectedFile:null,progressPercent:0,showProgress:!1,statusMessage:"",statusType:"",showStatusMessage:!1,extractedToken:"",showResult:!1,responseDetails:"",showResponseInfo:!1,debugDetails:"",showDebugInfo:!1,wssLink:"",isUploading:!1}},computed:{fileInfoText(){return this.selectedFile?`å·²é€‰æ‹©: ${this.selectedFile.name} (${this.formatFileSize(this.selectedFile.size)})`:""}},methods:{handleUploadAreaClick(r){r.target!==this.$refs.fileInput&&this.$refs.fileInput.click()},highlight(){document.getElementById("uploadArea").classList.add("dragover")},unhighlight(){document.getElementById("uploadArea").classList.remove("dragover")},handleDrop(r){this.unhighlight();const t=r.dataTransfer.files;t.length&&this.handleFiles(t)},handleFileChange(){this.$refs.fileInput.files.length&&this.handleFiles(this.$refs.fileInput.files)},handleFiles(r){const e=r[0];if(!e.name.toLowerCase().endsWith(".bin")){this.showStatus("è¯·é€‰æ‹©.binæ ¼å¼çš„æ–‡ä»¶","error");return}this.selectedFile=e},formatFileSize(r){if(r===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(r)/Math.log(e));return parseFloat((r/Math.pow(e,a)).toFixed(2))+" "+t[a]},async uploadFile(){if(!this.selectedFile){this.showStatus("è¯·å…ˆé€‰æ‹©æ–‡ä»¶","error");return}this.isUploading=!0,this.showProgress=!0,this.progressPercent=0,this.showStatus("æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...","");try{const r=await this.readFileAsArrayBuffer(this.selectedFile),e=new XMLHttpRequest;e.open("POST","https://xxz-xyzw.hortorgames.com/login/authuser?_seq=1",!0),e.responseType="arraybuffer",e.upload.addEventListener("progress",t=>{if(t.lengthComputable){const a=t.loaded/t.total*100;this.progressPercent=Math.round(a)}}),await new Promise((t,a)=>{e.addEventListener("load",()=>{if(e.status>=200&&e.status<300)try{const s=e.response;s?(this.extractRoleToken(s),this.showStatus("Tokenæå–æˆåŠŸï¼","success"),t()):(this.showStatus("ä¸Šä¼ æˆåŠŸï¼Œä½†å“åº”ä¸ºç©º","error"),a(new Error("Empty response")))}catch(s){this.showStatus("å¤„ç†å“åº”æ—¶å‡ºé”™: "+s.message,"error"),a(s)}else this.showStatus("ä¸Šä¼ å¤±è´¥: "+e.statusText,"error"),a(new Error(`HTTP error: ${e.status}`))}),e.addEventListener("error",()=>{this.showStatus("ä¸Šä¼ è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯","error"),a(new Error("Network error"))}),e.setRequestHeader("Content-Type","application/octet-stream"),e.send(r)})}catch(r){console.error("Upload error:",r)}finally{this.isUploading=!1}},readFileAsArrayBuffer(r){return new Promise((e,t)=>{const a=new FileReader;a.onload=s=>e(s.target.result),a.onerror=()=>t(a.error),a.readAsArrayBuffer(r)})},extractRoleToken(r){try{const e=new Uint8Array(r);let t="";for(let s=0;s<e.length;s++)e[s]>=32&&e[s]<=126?t+=String.fromCharCode(e[s]):t+=".";this.debugDetails=`ASCIIé¢„è§ˆ:
`+t,this.showDebugInfo=!0;const a=t.indexOf("Token");if(a!==-1){let s=a+5;for(;s<t.length;){const p=t[s];if(this.isBase64Char(p))break;s++}let o=s;for(;o<t.length&&this.isBase64Char(t[o]);)o++;const i=t.substring(s,o);if(i.length>0){this.extractedToken=i,this.showResult=!0,this.generateAndDisplayWssLink(i);let p="";for(let f=0;f<e.length;f++)(f+1)%16===0&&(p+=`
`),p+=e[f].toString(16).padStart(2,"0")+" ";this.responseDetails=p,this.showResponseInfo=!0,this.$nextTick(()=>{document.querySelector(".result-container").scrollIntoView({behavior:"smooth"})})}else this.showStatus("æ‰¾åˆ°Tokenæ ‡è®°ä½†æœªæ‰¾åˆ°Tokenå€¼","error")}else this.showStatus("åœ¨å“åº”ä¸­æœªæ‰¾åˆ°Tokenæ ‡è®°","error")}catch(e){this.showStatus("æå–Tokenæ—¶å‘ç”Ÿé”™è¯¯: "+e.message,"error")}},isBase64Char(r){return/[A-Za-z0-9+/=]/.test(r)},showStatus(r,e){this.statusMessage=r,this.statusType=e||"",this.showStatusMessage=!0},copyToken(){this.extractedToken&&navigator.clipboard.writeText(this.extractedToken).then(()=>this.showStatus("Tokenå·²å¤åˆ¶åˆ°å‰ªè´´æ¿","success")).catch(()=>this.showStatus("å¤åˆ¶å¤±è´¥","error"))},copyWssLink(){this.wssLink&&navigator.clipboard.writeText(this.wssLink).then(()=>this.showStatus("WSSé“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿","success")).catch(()=>this.showStatus("å¤åˆ¶å¤±è´¥","error"))},generateAndDisplayWssLink(r){const e=Date.now(),t=e*100+Math.floor(Math.random()*100),a=e+Math.floor(Math.random()*10);this.wssLink=`{"roleToken":"${r}","sessId":${t},"connId":${a},"isRestore":0}`}}},y={class:"container"},T={key:0,class:"file-info"},S={key:1,class:"progress-container"},x={class:"progress-bar"},I={class:"progress-text"},b=["disabled"],F={key:3,class:"result-container"},C={class:"token-display"},B={class:"token-info",style:{"margin-top":"20px","background-color":"#e8f5e9"}},D={class:"wss-link-display"},A={key:4,class:"debug-info"},M={class:"response-details"},L={key:5,class:"response-info"},R={class:"response-details"};function P(r,e,t,a,s,o){return h(),l("div",y,[e[17]||(e[17]=c('<div class="logo" data-v-f25970e0><span data-v-f25970e0>ğŸ”‘</span></div><h1 data-v-f25970e0>RoleToken æå–å·¥å…·</h1><p class="description" data-v-f25970e0>ä¸Šä¼ BINæ–‡ä»¶ä»æœåŠ¡å™¨å“åº”ä¸­æå–RoleTokenå¹¶ç”ŸæˆWebSocketé“¾æ¥</p><div class="api-info" data-v-f25970e0><h3 data-v-f25970e0>APIä¿¡æ¯</h3><div class="api-details" data-v-f25970e0><p data-v-f25970e0><strong data-v-f25970e0>ç«¯ç‚¹:</strong> https://xxz-xyzw.hortorgames.com/login/authuser?_seq=1</p><p data-v-f25970e0><strong data-v-f25970e0>æ–¹æ³•:</strong> POST</p><p data-v-f25970e0><strong data-v-f25970e0>è¯·æ±‚ä½“:</strong> BINæ–‡ä»¶å†…å®¹</p><p data-v-f25970e0><strong data-v-f25970e0>å“åº”:</strong> äºŒè¿›åˆ¶æ•°æ® (åŒ…å«RoleToken)</p></div></div>',4)),n("div",{class:"upload-area",id:"uploadArea",onClick:e[1]||(e[1]=(...i)=>o.handleUploadAreaClick&&o.handleUploadAreaClick(...i)),onDragenter:e[2]||(e[2]=g((...i)=>o.highlight&&o.highlight(...i),["prevent"])),onDragover:e[3]||(e[3]=g((...i)=>o.highlight&&o.highlight(...i),["prevent"])),onDragleave:e[4]||(e[4]=g((...i)=>o.unhighlight&&o.unhighlight(...i),["prevent"])),onDrop:e[5]||(e[5]=g((...i)=>o.handleDrop&&o.handleDrop(...i),["prevent"]))},[e[9]||(e[9]=n("div",{class:"upload-icon"},"ğŸ“‚",-1)),e[10]||(e[10]=n("p",{class:"upload-text"},"ç‚¹å‡»æˆ–æ‹–æ”¾BINæ–‡ä»¶åˆ°æ­¤å¤„",-1)),e[11]||(e[11]=n("p",{class:"upload-subtext"},"ä»…æ”¯æŒ .bin æ ¼å¼æ–‡ä»¶",-1)),n("input",{type:"file",ref:"fileInput",class:"file-input",accept:".bin",onChange:e[0]||(e[0]=(...i)=>o.handleFileChange&&o.handleFileChange(...i))},null,544)],32),s.selectedFile?(h(),l("div",T,d(o.fileInfoText),1)):u("",!0),s.showProgress?(h(),l("div",S,[n("div",x,[n("div",{class:"progress",style:k({width:s.progressPercent+"%"})},null,4)]),n("div",I,d(s.progressPercent)+"%",1)])):u("",!0),s.showStatusMessage?(h(),l("div",{key:2,class:w(["status-message",s.statusType])},d(s.statusMessage),3)):u("",!0),n("button",{class:"btn",onClick:e[6]||(e[6]=(...i)=>o.uploadFile&&o.uploadFile(...i)),disabled:!s.selectedFile||s.isUploading},"ä¸Šä¼ BINæ–‡ä»¶æå–Token",8,b),s.showResult?(h(),l("div",F,[e[13]||(e[13]=n("div",{class:"result-title"},"æå–åˆ°çš„ RoleToken:",-1)),n("div",C,d(s.extractedToken),1),n("button",{class:"copy-btn",onClick:e[7]||(e[7]=(...i)=>o.copyToken&&o.copyToken(...i))},"å¤åˆ¶Token"),e[14]||(e[14]=n("div",{class:"token-info"},[n("h3",null,"Tokenä½¿ç”¨è¯´æ˜"),n("p",null,"å°†æ­¤Tokenç”¨äºWebSocketè¿æ¥è®¤è¯ï¼š"),n("div",{class:"usage-example"},' ws://xxz-xyzw.hortorgames.com/agent?p={"roleToken":"ä½ çš„Token","sessId":175742937218840,"connId":1757429372191,"isRestore":0} ')],-1)),n("div",B,[e[12]||(e[12]=n("h3",null,"å®Œæ•´WebSocketé“¾æ¥",-1)),n("div",D,d(s.wssLink),1),n("button",{class:"copy-btn",onClick:e[8]||(e[8]=(...i)=>o.copyWssLink&&o.copyWssLink(...i)),style:{background:"#4caf50","margin-top":"10px"}},"å¤åˆ¶å®Œæ•´WSSé“¾æ¥")])])):u("",!0),s.showDebugInfo?(h(),l("div",A,[e[15]||(e[15]=n("h3",null,"è°ƒè¯•ä¿¡æ¯:",-1)),n("div",M,d(s.debugDetails),1)])):u("",!0),s.showResponseInfo?(h(),l("div",L,[e[16]||(e[16]=n("h3",null,"åŸå§‹å“åº”æ•°æ® (åå…­è¿›åˆ¶æ ¼å¼):",-1)),n("div",R,d(s.responseDetails),1)])):u("",!0)])}const W=v(m,[["render",P],["__scopeId","data-v-f25970e0"]]);export{W as default};
