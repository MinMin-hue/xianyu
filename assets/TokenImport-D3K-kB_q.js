import{d as P,c as w,o as m,a as n,m as y,n as A,t as M,p as Me,q as V,s as Re,v as Le,x as $e,r as R,y as q,b as Be,g as r,u as d,f as $,l as T,w as l,N as b,i as I,F as Ee,j as Ae,z as U,h as ze}from"./index-BH-S8nGy.js";import{_ as We}from"./xiaoyugan-Dwisk7G8.js";import{T as De,A as Y,H as Pe}from"./ThemeToggle-j2usGr5R.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as Oe,T as Ne,C as je,a as Q,E as He}from"./TrashBin-mriCgKnO.js";import{R as ee}from"./Refresh-Ddqf3QFR.js";const qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ve=n("path",{d:"M408 480H184a72 72 0 0 1-72-72V184a72 72 0 0 1 72-72h224a72 72 0 0 1 72 72v224a72 72 0 0 1-72 72z",fill:"currentColor"},null,-1),Ge=n("path",{d:"M160 80h235.88A72.12 72.12 0 0 0 328 32H104a72 72 0 0 0-72 72v224a72.12 72.12 0 0 0 48 67.88V160a80 80 0 0 1 80-80z",fill:"currentColor"},null,-1),Je=[Ve,Ge],Ke=P({name:"Copy",render:function(a,o){return m(),w("svg",qe,Je)}}),Ze={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Xe=n("path",{d:"M218.1 167.17c0 13 0 25.6 4.1 37.4c-43.1 50.6-156.9 184.3-167.5 194.5a20.17 20.17 0 0 0-6.7 15c0 8.5 5.2 16.7 9.6 21.3c6.6 6.9 34.8 33 40 28c15.4-15 18.5-19 24.8-25.2c9.5-9.3-1-28.3 2.3-36s6.8-9.2 12.5-10.4s15.8 2.9 23.7 3c8.3.1 12.8-3.4 19-9.2c5-4.6 8.6-8.9 8.7-15.6c.2-9-12.8-20.9-3.1-30.4s23.7 6.2 34 5s22.8-15.5 24.1-21.6s-11.7-21.8-9.7-30.7c.7-3 6.8-10 11.4-11s25 6.9 29.6 5.9c5.6-1.2 12.1-7.1 17.4-10.4c15.5 6.7 29.6 9.4 47.7 9.4c68.5 0 124-53.4 124-119.2S408.5 48 340 48s-121.9 53.37-121.9 119.17zM400 144a32 32 0 1 1-32-32a32 32 0 0 1 32 32z",fill:"currentColor"},null,-1),Ye=[Xe],Qe=P({name:"Key",render:function(a,o){return m(),w("svg",Ze,Ye)}}),es={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ss=n("path",{d:"M200.66 352H144a96 96 0 0 1 0-192h55.41",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48"},null,-1),ts=n("path",{d:"M312.59 160H368a96 96 0 0 1 0 192h-56.66",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48"},null,-1),os=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M169.07 256h175.86"},null,-1),rs=[ss,ts,os],ns=P({name:"Link",render:function(a,o){return m(),w("svg",es,rs)}}),ls={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},as=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"48",d:"M88 152h336"},null,-1),is=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"48",d:"M88 256h336"},null,-1),cs=n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"48",d:"M88 360h336"},null,-1),us=[as,is,cs],ds=P({name:"Menu",render:function(a,o){return m(),w("svg",ls,us)}}),ps={name:"ImportToken",data(){return{selectedFile:null,progressPercent:0,showProgress:!1,statusMessage:"",statusType:"",showStatusMessage:!1,extractedToken:"",showResult:!1,responseDetails:"",showResponseInfo:!1,debugDetails:"",showDebugInfo:!1,wssLink:"",isUploading:!1}},computed:{fileInfoText(){return this.selectedFile?`å·²é€‰æ‹©: ${this.selectedFile.name} (${this.formatFileSize(this.selectedFile.size)})`:""}},methods:{handleUploadAreaClick(u){u.target!==this.$refs.fileInput&&this.$refs.fileInput.click()},highlight(){document.getElementById("uploadArea").classList.add("dragover")},unhighlight(){document.getElementById("uploadArea").classList.remove("dragover")},handleDrop(u){this.unhighlight();const o=u.dataTransfer.files;o.length&&this.handleFiles(o)},handleFileChange(){this.$refs.fileInput.files.length&&this.handleFiles(this.$refs.fileInput.files)},handleFiles(u){const a=u[0];if(!a.name.toLowerCase().endsWith(".bin")){this.showStatus("è¯·é€‰æ‹©.binæ ¼å¼çš„æ–‡ä»¶","error");return}this.selectedFile=a},formatFileSize(u){if(u===0)return"0 Bytes";const a=1024,o=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(u)/Math.log(a));return parseFloat((u/Math.pow(a,f)).toFixed(2))+" "+o[f]},async uploadFile(){var u;if(!this.selectedFile){this.showStatus("è¯·å…ˆé€‰æ‹©æ–‡ä»¶","error");return}this.isUploading=!0,this.showProgress=!0,this.progressPercent=0,this.showStatus("æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...","");try{const a=await this.readFileAsArrayBuffer(this.selectedFile),o=new XMLHttpRequest;o.open("POST","https://xxz-xyzw.hortorgames.com/login/authuser?_seq=1",!0),o.responseType="arraybuffer",o.upload.addEventListener("progress",f=>{if(f.lengthComputable){const t=f.loaded/f.total*100;this.progressPercent=Math.round(t)}}),await new Promise((f,t)=>{o.addEventListener("load",()=>{if(o.status>=200&&o.status<300)try{const c=o.response;c?(this.extractRoleToken(c),this.showStatus("Tokenæå–æˆåŠŸï¼","success"),f()):(this.showStatus("ä¸Šä¼ æˆåŠŸï¼Œä½†å“åº”ä¸ºç©º","error"),t(new Error("Empty response")))}catch(c){this.showStatus("å¤„ç†å“åº”æ—¶å‡ºé”™: "+c.message,"error"),t(c)}else this.showStatus("ä¸Šä¼ å¤±è´¥: "+o.statusText,"error"),t(new Error(`HTTP error: ${o.status}`))}),o.addEventListener("error",()=>{this.showStatus("ä¸Šä¼ è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯","error"),t(new Error("Network error"))}),o.setRequestHeader("Content-Type","application/octet-stream"),o.send(a)}),this.$emit("sucessData",this.wssLink,(u=this.selectedFile.name)==null?void 0:u.split(".")[0])}catch(a){console.error("Upload error:",a)}finally{this.isUploading=!1}},readFileAsArrayBuffer(u){return new Promise((a,o)=>{const f=new FileReader;f.onload=t=>a(t.target.result),f.onerror=()=>o(f.error),f.readAsArrayBuffer(u)})},extractRoleToken(u){try{const a=new Uint8Array(u);let o="";for(let t=0;t<a.length;t++)a[t]>=32&&a[t]<=126?o+=String.fromCharCode(a[t]):o+=".";this.debugDetails=`ASCIIé¢„è§ˆ:
`+o,this.showDebugInfo=!0;const f=o.indexOf("Token");if(f!==-1){let t=f+5;for(;t<o.length;){const S=o[t];if(this.isBase64Char(S))break;t++}let c=t;for(;c<o.length&&this.isBase64Char(o[c]);)c++;const p=o.substring(t,c);if(p.length>0){this.extractedToken=p,this.showResult=!0,this.generateAndDisplayWssLink(p);let S="";for(let L=0;L<a.length;L++)(L+1)%16===0&&(S+=`
`),S+=a[L].toString(16).padStart(2,"0")+" ";this.responseDetails=S,this.showResponseInfo=!0,this.$nextTick(()=>{document.querySelector(".result-container").scrollIntoView({behavior:"smooth"})})}else this.showStatus("æ‰¾åˆ°Tokenæ ‡è®°ä½†æœªæ‰¾åˆ°Tokenå€¼","error")}else this.showStatus("åœ¨å“åº”ä¸­æœªæ‰¾åˆ°Tokenæ ‡è®°","error")}catch(a){this.showStatus("æå–Tokenæ—¶å‘ç”Ÿé”™è¯¯: "+a.message,"error")}},isBase64Char(u){return/[A-Za-z0-9+/=]/.test(u)},showStatus(u,a){this.statusMessage=u,this.statusType=a||"",this.showStatusMessage=!0},copyToken(){this.extractedToken&&navigator.clipboard.writeText(this.extractedToken).then(()=>this.showStatus("Tokenå·²å¤åˆ¶åˆ°å‰ªè´´æ¿","success")).catch(()=>this.showStatus("å¤åˆ¶å¤±è´¥","error"))},copyWssLink(){this.wssLink&&navigator.clipboard.writeText(this.wssLink).then(()=>this.showStatus("WSSé“¾æŽ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿","success")).catch(()=>this.showStatus("å¤åˆ¶å¤±è´¥","error"))},generateAndDisplayWssLink(u){const a=Date.now(),o=a*100+Math.floor(Math.random()*100),f=a+Math.floor(Math.random()*10);this.wssLink=`{"roleToken":"${u}","sessId":${o},"connId":${f},"isRestore":0}`}}},hs={class:"container"},ms={key:0,class:"file-info"},fs={key:1,class:"progress-container"},ks={class:"progress-bar"},gs={class:"progress-text"},vs=["disabled"];function _s(u,a,o,f,t,c){return m(),w("div",hs,[n("div",{class:"upload-area",id:"uploadArea",onClick:a[1]||(a[1]=(...p)=>c.handleUploadAreaClick&&c.handleUploadAreaClick(...p)),onDragenter:a[2]||(a[2]=A((...p)=>c.highlight&&c.highlight(...p),["prevent"])),onDragover:a[3]||(a[3]=A((...p)=>c.highlight&&c.highlight(...p),["prevent"])),onDragleave:a[4]||(a[4]=A((...p)=>c.unhighlight&&c.unhighlight(...p),["prevent"])),onDrop:a[5]||(a[5]=A((...p)=>c.handleDrop&&c.handleDrop(...p),["prevent"]))},[a[7]||(a[7]=n("div",{class:"upload-icon"},"ðŸ“‚",-1)),a[8]||(a[8]=n("p",{class:"upload-text"},"ç‚¹å‡»æˆ–æ‹–æ”¾BINæ–‡ä»¶åˆ°æ­¤å¤„",-1)),a[9]||(a[9]=n("p",{class:"upload-subtext"},"ä»…æ”¯æŒ .bin æ ¼å¼æ–‡ä»¶",-1)),n("input",{type:"file",ref:"fileInput",class:"file-input",accept:".bin",onChange:a[0]||(a[0]=(...p)=>c.handleFileChange&&c.handleFileChange(...p))},null,544)],32),t.selectedFile?(m(),w("div",ms,M(c.fileInfoText),1)):y("",!0),t.showProgress?(m(),w("div",fs,[n("div",ks,[n("div",{class:"progress",style:Me({width:t.progressPercent+"%"})},null,4)]),n("div",gs,M(t.progressPercent)+"%",1)])):y("",!0),t.showStatusMessage?(m(),w("div",{key:2,class:V(["status-message",t.statusType])},M(t.statusMessage),3)):y("",!0),n("button",{class:"btn",onClick:a[6]||(a[6]=(...p)=>c.uploadFile&&c.uploadFile(...p)),disabled:!t.selectedFile||t.isUploading},"ä¸Šä¼ BINæ–‡ä»¶æå–Token",8,vs)])}const ws=se(ps,[["render",_s],["__scopeId","data-v-742201f0"]]),Ts={class:"token-import-page"},bs={class:"container"},ys={class:"page-header"},xs={class:"header-content"},Us={class:"header-top"},Ss={key:0,class:"import-section"},Cs={class:"import-card"},Fs={class:"card-header"},Is={class:"optional-fields"},Ms={class:"form-actions"},Rs={class:"optional-fields"},Ls={class:"form-actions"},$s={key:1,class:"tokens-section"},Bs={class:"section-header"},Es={class:"header-actions"},As={class:"tokens-grid"},zs=["onClick"],Ws={class:"card-header"},Ds={class:"token-info"},Ps={class:"token-name"},Os={class:"token-meta"},Ns={key:0,class:"meta-item"},js={class:"card-actions"},Hs={class:"card-body"},qs={class:"token-display"},Vs={class:"token-value"},Gs={class:"connection-status"},Js={class:"status-indicator"},Ks={class:"status-text"},Zs={class:"connection-actions"},Xs={class:"token-timestamps"},Ys={class:"timestamp-item"},Qs={class:"timestamp-value"},et={class:"timestamp-item"},st={class:"timestamp-value"},tt={key:0,class:"card-footer"},ot={key:2,class:"empty-state"},rt={class:"modal-actions"},nt={__name:"TokenImport",setup(u){const a=ze(),o=Re(),f=Le(),t=$e(),c=R(!1),p=R(!1),S=R(!1),L=R(null),O=R(null),N=R(null),z=R(null),W=R("manual"),j=R(new Set),v=q({name:"",base64Token:"",server:"",wsUrl:""}),k=q({name:"",url:"",server:"",wsUrl:""}),C=q({name:"",server:"",wsUrl:""}),te={name:[{required:!0,message:"è¯·è¾“å…¥Tokenåç§°",trigger:"blur"}],base64Token:[{required:!0,message:"è¯·è¾“å…¥Base64 Token",trigger:"blur"}]},oe={name:[{required:!0,message:"è¯·è¾“å…¥Tokenåç§°",trigger:"blur"}],url:[{required:!0,message:"è¯·è¾“å…¥TokenèŽ·å–åœ°å€",trigger:"blur"},{type:"url",message:"è¯·è¾“å…¥æœ‰æ•ˆçš„URLåœ°å€",trigger:"blur"}]},re={name:[{required:!0,message:"è¯·è¾“å…¥Tokenåç§°",trigger:"blur"}]},ne=[{label:"å¯¼å‡ºæ‰€æœ‰Token",key:"export"},{label:"å¯¼å…¥Tokenæ–‡ä»¶",key:"import"},{label:"æ¸…ç†è¿‡æœŸToken",key:"clean"},{label:"æ–­å¼€æ‰€æœ‰è¿žæŽ¥",key:"disconnect"},{label:"æ¸…é™¤æ‰€æœ‰Token",key:"clear"}],le=async()=>{var s;if(L.value)try{await L.value.validate(),p.value=!0;const e=t.importBase64Token(v.name,v.base64Token,{server:v.server,wsUrl:v.wsUrl,importMethod:"manual"});if(e.success)o.success(e.message),e.details&&console.log("Tokenå¯¼å…¥è¯¦æƒ…:",e.details),ie(),c.value=!1;else{const F=e.error||e.message||"Tokenå¯¼å…¥å¤±è´¥";o.error(F),console.error("Tokenå¯¼å…¥é”™è¯¯è¯¦æƒ…:",{error:e.error,message:e.message,originalToken:((s=v.base64Token)==null?void 0:s.substring(0,50))+"..."})}}catch{}finally{p.value=!1}},ae=async()=>{var s;if(O.value)try{await O.value.validate(),p.value=!0;let e;if(k.url.startsWith(window.location.origin)||k.url.startsWith("/")||k.url.startsWith("http://localhost")||k.url.startsWith("http://127.0.0.1"))e=await fetch(k.url);else try{e=await fetch(k.url,{method:"GET",headers:{Accept:"application/json"},mode:"cors"})}catch(_){throw new Error(`è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢ã€‚è¯·ç¡®ä¿ç›®æ ‡æœåŠ¡å™¨æ”¯æŒCORSï¼Œæˆ–ä½¿ç”¨æµè§ˆå™¨æ‰©å±•/ä»£ç†æœåŠ¡å™¨ã€‚é”™è¯¯è¯¦æƒ…: ${_.message}`)}if(!e.ok)throw new Error(`è¯·æ±‚å¤±è´¥: ${e.status} ${e.statusText}`);const g=await e.json();if(!g.token)throw new Error("è¿”å›žæ•°æ®ä¸­æœªæ‰¾åˆ°tokenå­—æ®µ");const h=t.importBase64Token(k.name,g.token,{server:k.server||g.server,wsUrl:k.wsUrl,sourceUrl:k.url,importMethod:"url"});if(h.success)o.success(h.message),h.details&&console.log("URL Tokenå¯¼å…¥è¯¦æƒ…:",h.details),ce(),c.value=!1;else{const _=h.error||h.message||"URL Tokenå¯¼å…¥å¤±è´¥";o.error(_),console.error("URL Tokenå¯¼å…¥é”™è¯¯è¯¦æƒ…:",{error:h.error,message:h.message,sourceUrl:k.url,receivedToken:((s=g==null?void 0:g.token)==null?void 0:s.substring(0,50))+"..."})}}catch(e){console.error("URLèŽ·å–Tokenå¤±è´¥:",e),o.error(e.message||"URLèŽ·å–Tokenå¤±è´¥")}finally{p.value=!1}},G=async s=>{if(!s.sourceUrl){o.warning("è¯¥Tokenæœªé…ç½®åˆ·æ–°åœ°å€");return}j.value.add(s.id);try{let e;if(s.sourceUrl.startsWith(window.location.origin)||s.sourceUrl.startsWith("/")||s.sourceUrl.startsWith("http://localhost")||s.sourceUrl.startsWith("http://127.0.0.1"))e=await fetch(s.sourceUrl);else try{e=await fetch(s.sourceUrl,{method:"GET",headers:{Accept:"application/json"},mode:"cors"})}catch(h){throw new Error(`è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢ã€‚è¯·ç¡®ä¿ç›®æ ‡æœåŠ¡å™¨æ”¯æŒCORSã€‚é”™è¯¯è¯¦æƒ…: ${h.message}`)}if(!e.ok)throw new Error(`è¯·æ±‚å¤±è´¥: ${e.status} ${e.statusText}`);const g=await e.json();if(!g.token)throw new Error("è¿”å›žæ•°æ®ä¸­æœªæ‰¾åˆ°tokenå­—æ®µ");t.updateToken(s.id,{token:g.token,server:g.server||s.server,lastRefreshed:Date.now()}),t.getWebSocketStatus(s.id)==="connected"&&(t.closeWebSocketConnection(s.id),setTimeout(()=>{t.createWebSocketConnection(s.id,g.token,s.wsUrl)},500)),o.success("Tokenåˆ·æ–°æˆåŠŸ")}catch(e){console.error("åˆ·æ–°Tokenå¤±è´¥:",e),o.error(e.message||"Tokenåˆ·æ–°å¤±è´¥")}finally{j.value.delete(s.id)}},ie=()=>{Object.keys(v).forEach(s=>{v[s]=""})},ce=()=>{Object.keys(k).forEach(s=>{k[s]=""})},ue=s=>{t.selectToken(s.id),o.success(`å·²é€‰æ‹©ï¼š${s.name}`)},B=s=>t.getWebSocketStatus(s),de=s=>{switch(B(s)){case"connected":return"å·²è¿žæŽ¥";case"connecting":return"è¿žæŽ¥ä¸­";case"error":return"è¿žæŽ¥é”™è¯¯";default:return"æœªè¿žæŽ¥"}},pe=s=>{B(s.id)==="connected"?(t.closeWebSocketConnection(s.id),o.info("WebSocketè¿žæŽ¥å·²æ–­å¼€")):(t.createWebSocketConnection(s.id,s.token,s.wsUrl),o.success("æ­£åœ¨å»ºç«‹WebSocketè¿žæŽ¥..."))},he=s=>{const e=[{label:"ç¼–è¾‘",key:"edit",icon:()=>U(b,null,{default:()=>U(je)})},{label:"å¤åˆ¶Token",key:"copy",icon:()=>U(b,null,{default:()=>U(Ke)})}];return s.importMethod==="url"&&s.sourceUrl?e.push({label:"ä»ŽURLåˆ·æ–°",key:"refresh-url",icon:()=>U(b,null,{default:()=>U(Oe)})}):e.push({label:"åˆ·æ–°Token",key:"refresh",icon:()=>U(b,null,{default:()=>U(ee)})}),e.push({label:"é‡æ–°è¿žæŽ¥",key:"reconnect",icon:()=>U(b,null,{default:()=>U(ns)})},{type:"divider"},{label:"åˆ é™¤",key:"delete",icon:()=>U(b,null,{default:()=>U(Ne)}),props:{style:{color:"#e74c3c"}}}),e},me=async(s,e)=>{switch(s){case"edit":fe(e);break;case"copy":ge(e);break;case"refresh":o.info("æ‰‹åŠ¨æ·»åŠ çš„Tokenæš‚ä¸æ”¯æŒåˆ·æ–°ï¼Œè¯·é‡æ–°å¯¼å…¥");break;case"refresh-url":G(e);break;case"reconnect":ve(e);break;case"delete":_e(e);break}},fe=s=>{z.value=s,Object.assign(C,{name:s.name,server:s.server||"",wsUrl:s.wsUrl||""}),S.value=!0},ke=async()=>{if(!(!N.value||!z.value))try{await N.value.validate(),t.updateToken(z.value.id,{name:C.name,server:C.server,wsUrl:C.wsUrl}),o.success("Tokenä¿¡æ¯å·²æ›´æ–°"),S.value=!1,z.value=null}catch{}},ge=async s=>{try{await navigator.clipboard.writeText(s.token),o.success("Tokenå·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{o.error("å¤åˆ¶å¤±è´¥")}},ve=s=>{t.closeWebSocketConnection(s.id),setTimeout(()=>{t.createWebSocketConnection(s.id,s.token,s.wsUrl),o.success("æ­£åœ¨é‡æ–°è¿žæŽ¥...")},500)},_e=s=>{f.warning({title:"åˆ é™¤Token",content:`ç¡®å®šè¦åˆ é™¤Token "${s.name}" å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ¢å¤ã€‚`,positiveText:"ç¡®å®šåˆ é™¤",negativeText:"å–æ¶ˆ",onPositiveClick:()=>{t.removeToken(s.id),o.success("Tokenå·²åˆ é™¤")}})},we=s=>{switch(s){case"export":Te();break;case"import":be();break;case"clean":ye();break;case"disconnect":xe();break;case"clear":Ue();break}},Te=()=>{try{const s=t.exportTokens(),e=JSON.stringify(s,null,2),F=new Blob([e],{type:"application/json"}),g=document.createElement("a");g.href=URL.createObjectURL(F),g.download=`tokens_backup_${new Date().toISOString().split("T")[0]}.json`,g.click(),o.success("Tokenæ•°æ®å·²å¯¼å‡º")}catch{o.error("å¯¼å‡ºå¤±è´¥")}},be=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=e=>{const F=e.target.files[0];if(F){const g=new FileReader;g.onload=h=>{try{const _=JSON.parse(h.target.result),E=t.importTokens(_);E.success?o.success(E.message):o.error(E.message)}catch{o.error("æ–‡ä»¶æ ¼å¼é”™è¯¯")}},g.readAsText(F)}},s.click()},ye=()=>{const s=t.cleanExpiredTokens();o.success(`å·²æ¸…ç† ${s} ä¸ªè¿‡æœŸToken`)},xe=()=>{t.gameTokens.forEach(s=>{t.closeWebSocketConnection(s.id)}),o.success("æ‰€æœ‰è¿žæŽ¥å·²æ–­å¼€")},Ue=()=>{f.error({title:"æ¸…é™¤æ‰€æœ‰Token",content:"ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰Tokenå—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ¢å¤ï¼",positiveText:"ç¡®å®šæ¸…é™¤",negativeText:"å–æ¶ˆ",onPositiveClick:()=>{t.clearAllTokens(),o.success("æ‰€æœ‰Tokenå·²æ¸…é™¤")}})},Se=s=>{if(!s)return"";const e=s.length;return e<=8?s:s.substring(0,4)+"***"+s.substring(e-4)},J=s=>new Date(s).toLocaleString("zh-CN"),K=()=>{a.push("/dashboard")};Be(()=>{t.initTokenStore(),t.hasTokens||(c.value=!0)});const Ce=(s,e)=>{v.base64Token=s,v.name=e};return(s,e)=>{const F=I("n-radio-button"),g=I("n-radio-group"),h=I("n-input"),_=I("n-form-item"),E=I("n-collapse-item"),Z=I("n-collapse"),x=I("n-button"),H=I("n-form"),X=I("n-dropdown"),Fe=I("n-empty"),Ie=I("n-modal");return m(),w("div",Ts,[n("div",bs,[n("div",ys,[n("div",xs,[n("div",Us,[e[17]||(e[17]=n("img",{src:We,alt:"XYZW",class:"brand-logo"},null,-1)),r(De)]),e[18]||(e[18]=n("h1",null,"æ¸¸æˆTokenç®¡ç†",-1))])]),!d(t).hasTokens||c.value?(m(),w("div",Ss,[r(ws,{onSucessData:Ce,style:{"margin-bottom":"20px"}}),n("div",Cs,[n("div",Fs,[n("h2",null,[r(d(b),null,{default:l(()=>[r(d(Y))]),_:1}),e[19]||(e[19]=T(" æ·»åŠ æ¸¸æˆToken ",-1))]),r(g,{value:W.value,"onUpdate:value":e[0]||(e[0]=i=>W.value=i),class:"import-method-tabs",size:"small"},{default:l(()=>[r(F,{value:"manual"},{default:l(()=>e[20]||(e[20]=[T(" æ‰‹åŠ¨è¾“å…¥ ",-1)])),_:1,__:[20]}),r(F,{value:"url"},{default:l(()=>e[21]||(e[21]=[T(" URLèŽ·å– ",-1)])),_:1,__:[21]})]),_:1},8,["value"])]),W.value==="manual"?(m(),$(H,{key:0,ref_key:"importFormRef",ref:L,model:v,rules:te,"label-placement":"top",size:"large","show-label":!0},{default:l(()=>[r(_,{label:"æ¸¸æˆè§’è‰²åç§°",path:"name","show-label":!0},{default:l(()=>[r(h,{value:v.name,"onUpdate:value":e[1]||(e[1]=i=>v.name=i),placeholder:"ä¾‹å¦‚ï¼šä¸»å·æˆ˜å£«",clearable:""},null,8,["value"])]),_:1}),r(_,{label:"Tokenå­—ç¬¦ä¸²",path:"base64Token","show-label":!0},{default:l(()=>[r(h,{value:v.base64Token,"onUpdate:value":e[2]||(e[2]=i=>v.base64Token=i),type:"textarea",rows:3,placeholder:"ç²˜è´´Tokenå­—ç¬¦ä¸²...",clearable:""},null,8,["value"])]),_:1}),r(Z,null,{default:l(()=>[r(E,{title:"è§’è‰²è¯¦æƒ… (å¯é€‰)",name:"optional"},{default:l(()=>[n("div",Is,[r(_,{label:"æœåŠ¡å™¨"},{default:l(()=>[r(h,{value:v.server,"onUpdate:value":e[3]||(e[3]=i=>v.server=i),placeholder:"æœåŠ¡å™¨åç§°"},null,8,["value"])]),_:1}),r(_,{label:"è‡ªå®šä¹‰è¿žæŽ¥åœ°å€"},{default:l(()=>[r(h,{value:v.wsUrl,"onUpdate:value":e[4]||(e[4]=i=>v.wsUrl=i),placeholder:"ç•™ç©ºä½¿ç”¨é»˜è®¤è¿žæŽ¥"},null,8,["value"])]),_:1})])]),_:1})]),_:1}),n("div",Ms,[r(x,{type:"primary",size:"large",block:"",loading:p.value,onClick:le},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Q))]),_:1})]),default:l(()=>[e[22]||(e[22]=T(" æ·»åŠ Token ",-1))]),_:1,__:[22]},8,["loading"]),d(t).hasTokens?(m(),$(x,{key:0,size:"large",block:"",onClick:e[5]||(e[5]=i=>c.value=!1)},{default:l(()=>e[23]||(e[23]=[T(" å–æ¶ˆ ",-1)])),_:1,__:[23]})):y("",!0)])]),_:1},8,["model"])):y("",!0),W.value==="url"?(m(),$(H,{key:1,ref_key:"urlFormRef",ref:O,model:k,rules:oe,"label-placement":"top",size:"large"},{default:l(()=>[r(_,{label:"æ¸¸æˆè§’è‰²åç§°",path:"name"},{default:l(()=>[r(h,{value:k.name,"onUpdate:value":e[6]||(e[6]=i=>k.name=i),placeholder:"ä¾‹å¦‚ï¼šä¸»å·æˆ˜å£«",clearable:""},null,8,["value"])]),_:1}),r(_,{label:"TokenèŽ·å–åœ°å€",path:"url"},{feedback:l(()=>e[24]||(e[24]=[n("div",{class:"form-tips"},[n("span",{class:"form-tip"}," æŽ¥å£åº”è¿”å›žåŒ…å«tokenå­—æ®µçš„JSONæ•°æ® "),n("span",{class:"form-tip cors-tip"}," æ³¨æ„ï¼šå¦‚æžœæ˜¯è·¨åŸŸURLï¼ŒæœåŠ¡å™¨éœ€è¦æ”¯æŒCORSï¼Œå¦åˆ™ä¼šè¢«æµè§ˆå™¨é˜»æ­¢ ")],-1)])),default:l(()=>[r(h,{value:k.url,"onUpdate:value":e[7]||(e[7]=i=>k.url=i),placeholder:"è¾“å…¥APIæŽ¥å£åœ°å€...",clearable:""},null,8,["value"])]),_:1}),r(Z,null,{default:l(()=>[r(E,{title:"è§’è‰²è¯¦æƒ… (å¯é€‰)",name:"optional"},{default:l(()=>[n("div",Rs,[r(_,{label:"æœåŠ¡å™¨"},{default:l(()=>[r(h,{value:k.server,"onUpdate:value":e[8]||(e[8]=i=>k.server=i),placeholder:"æœåŠ¡å™¨åç§°"},null,8,["value"])]),_:1}),r(_,{label:"è‡ªå®šä¹‰è¿žæŽ¥åœ°å€"},{default:l(()=>[r(h,{value:k.wsUrl,"onUpdate:value":e[9]||(e[9]=i=>k.wsUrl=i),placeholder:"ç•™ç©ºä½¿ç”¨é»˜è®¤è¿žæŽ¥"},null,8,["value"])]),_:1})])]),_:1})]),_:1}),n("div",Ls,[r(x,{type:"primary",size:"large",block:"",loading:p.value,onClick:ae},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Q))]),_:1})]),default:l(()=>[e[25]||(e[25]=T(" èŽ·å–å¹¶æ·»åŠ Token ",-1))]),_:1,__:[25]},8,["loading"]),d(t).hasTokens?(m(),$(x,{key:0,size:"large",block:"",onClick:e[10]||(e[10]=i=>c.value=!1)},{default:l(()=>e[26]||(e[26]=[T(" å–æ¶ˆ ",-1)])),_:1,__:[26]})):y("",!0)])]),_:1},8,["model"])):y("",!0)])])):y("",!0),d(t).hasTokens?(m(),w("div",$s,[n("div",Bs,[n("h2",null,"æˆ‘çš„Tokenåˆ—è¡¨ ("+M(d(t).gameTokens.length)+"ä¸ª)",1),n("div",Es,[d(t).selectedToken?(m(),$(x,{key:0,type:"success",onClick:K},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Pe))]),_:1})]),default:l(()=>[e[27]||(e[27]=T(" è¿”å›žæŽ§åˆ¶å° ",-1))]),_:1,__:[27]})):y("",!0),c.value?y("",!0):(m(),$(x,{key:1,type:"primary",onClick:e[11]||(e[11]=i=>c.value=!0)},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(Y))]),_:1})]),default:l(()=>[e[28]||(e[28]=T(" æ·»åŠ Token ",-1))]),_:1,__:[28]})),r(X,{options:ne,onSelect:we},{default:l(()=>[r(x,null,{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(ds))]),_:1})]),default:l(()=>[e[29]||(e[29]=T(" æ‰¹é‡æ“ä½œ ",-1))]),_:1,__:[29]})]),_:1})])]),n("div",As,[(m(!0),w(Ee,null,Ae(d(t).gameTokens,i=>(m(),w("div",{key:i.id,class:V(["token-card",{active:i.id===d(t).selectedTokenId,connected:B(i.id)==="connected"}]),onClick:D=>ue(i)},[n("div",Ws,[n("div",Ds,[n("h3",Ps,M(i.name),1),n("div",Os,[i.server?(m(),w("span",Ns,M(i.server),1)):y("",!0)])]),n("div",js,[r(X,{options:he(i),onSelect:D=>me(D,i)},{default:l(()=>[r(x,{text:""},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(He))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])])]),n("div",Hs,[n("div",qs,[e[30]||(e[30]=n("span",{class:"token-label"},"Token:",-1)),n("code",Vs,M(Se(i.token)),1)]),n("div",Gs,[n("div",Js,[n("span",{class:V(["status-dot",B(i.id)])},null,2),n("span",Ks,M(de(i.id)),1)]),n("div",Zs,[i.sourceUrl?(m(),$(x,{key:0,size:"small",type:"default",loading:j.value.has(i.id),onClick:A(D=>G(i),["stop"])},{icon:l(()=>[r(d(b),null,{default:l(()=>[r(d(ee))]),_:1})]),default:l(()=>[e[31]||(e[31]=T(" åˆ·æ–° ",-1))]),_:2,__:[31]},1032,["loading","onClick"])):y("",!0),r(x,{size:"small",type:B(i.id)==="connected"?"warning":"primary",onClick:A(D=>pe(i),["stop"])},{default:l(()=>[T(M(B(i.id)==="connected"?"æ–­å¼€":"è¿žæŽ¥"),1)]),_:2},1032,["type","onClick"])])]),n("div",Xs,[n("div",Ys,[e[32]||(e[32]=n("span",{class:"timestamp-label"},"åˆ›å»ºï¼š",-1)),n("span",Qs,M(J(i.createdAt)),1)]),n("div",et,[e[33]||(e[33]=n("span",{class:"timestamp-label"},"ä½¿ç”¨ï¼š",-1)),n("span",st,M(J(i.lastUsed)),1)])])]),i.id===d(t).selectedTokenId?(m(),w("div",tt,[r(x,{type:"primary",block:"",onClick:K},{default:l(()=>e[34]||(e[34]=[T(" å¼€å§‹ä»»åŠ¡ç®¡ç† ",-1)])),_:1,__:[34]})])):y("",!0)],10,zs))),128))])])):y("",!0),!d(t).hasTokens&&!c.value?(m(),w("div",ot,[r(Fe,{size:"large",description:"è¿˜æ²¡æœ‰å¯¼å…¥ä»»ä½•Token"},{icon:l(()=>[r(d(b),{size:"64"},{default:l(()=>[r(d(Qe))]),_:1})]),_:1})])):y("",!0)]),r(Ie,{show:S.value,"onUpdate:show":e[16]||(e[16]=i=>S.value=i),preset:"card",title:"ç¼–è¾‘Token",style:{width:"500px"}},{footer:l(()=>[n("div",rt,[r(x,{onClick:e[15]||(e[15]=i=>S.value=!1)},{default:l(()=>e[35]||(e[35]=[T(" å–æ¶ˆ ",-1)])),_:1,__:[35]}),r(x,{type:"primary",onClick:ke},{default:l(()=>e[36]||(e[36]=[T(" ä¿å­˜ ",-1)])),_:1,__:[36]})])]),default:l(()=>[r(H,{ref_key:"editFormRef",ref:N,model:C,rules:re,"label-placement":"left","label-width":"80px"},{default:l(()=>[r(_,{label:"åç§°",path:"name"},{default:l(()=>[r(h,{value:C.name,"onUpdate:value":e[12]||(e[12]=i=>C.name=i)},null,8,["value"])]),_:1}),r(_,{label:"æœåŠ¡å™¨"},{default:l(()=>[r(h,{value:C.server,"onUpdate:value":e[13]||(e[13]=i=>C.server=i)},null,8,["value"])]),_:1}),r(_,{label:"WebSocketåœ°å€"},{default:l(()=>[r(h,{value:C.wsUrl,"onUpdate:value":e[14]||(e[14]=i=>C.wsUrl=i)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])])}}},pt=se(nt,[["__scopeId","data-v-d340f9a8"]]);export{pt as default};
